import{_ as p,c as i,b as t,d as _,t as d,w as h,v,F as g,g as w,j as f,k as m,s as k,l as S,m as L,o as l,p as C,a as c}from"./index-C955rGbu.js";const T={name:"SearchResultsView",data(){return{searchQuery:"",contentType:"all",sortBy:"relevance",results:[],isLoading:!1,error:null,savedItems:new Set}},computed:{filteredResults(){let s=[...this.results];return this.contentType!=="all"&&(s=s.filter(e=>this.contentType==="movies"?e.media_type==="movie":this.contentType==="shows"?e.media_type==="tv":!0)),s.sort((e,o)=>{switch(this.sortBy){case"rating":return(o.vote_average||0)-(e.vote_average||0);case"year":return this.getYear(o)-this.getYear(e);case"title":return(e.title||e.name).localeCompare(o.title||o.name);default:return 0}})}},methods:{async performSearch(){if(this.searchQuery){this.isLoading=!0,this.error=null;try{const[s,e]=await Promise.all([k(this.searchQuery),S(this.searchQuery)]);this.results=[...s.map(o=>({...o,media_type:"movie"})),...e.map(o=>({...o,media_type:"tv"}))],this.results.forEach(o=>{L(o.id,o.media_type)&&this.savedItems.add(o.id)})}catch(s){console.error("Search error:",s),this.error="Failed to fetch search results. Please try again."}finally{this.isLoading=!1}}},getImageUrl(s){return s?`https://image.tmdb.org/t/p/w500${s}`:"/placeholder.jpg"},getYear(s){const e=s.release_date||s.first_air_date;return e?new Date(e).getFullYear():""},truncateOverview(s){return s.length>150?s.slice(0,147)+"...":s},getCastList(s){return s.slice(0,3).map(e=>e.name).join(", ")},navigateToDetails(s){const e=s.media_type==="movie"?"/movie/":"/tv-show/";this.$router.push(e+s.id)},async addToWatchlist(s){try{this.isItemSaved(s)?(await f(s.id),this.savedItems.delete(s.id)):(await m({id:s.id,type:s.media_type}),this.savedItems.add(s.id))}catch(e){console.error("Error updating watchlist:",e)}},isItemSaved(s){return this.savedItems.has(s.id)}},created(){this.searchQuery=this.$route.query.q||"",this.searchQuery&&this.performSearch()},watch:{"$route.query.q"(s){this.searchQuery!==s&&(this.searchQuery=s,this.performSearch())}}},V={class:"search-results-view"},M={class:"page-hero"},x={class:"hero-container"},I={class:"hero-content"},B={class:"page-title"},R={class:"highlight"},b={class:"filter-controls"},Q={class:"filter-select"},j={class:"filter-select"},D={key:0,class:"loading-container"},F={key:1,class:"error-container"},Y={key:2,class:"content-section"},q={key:0,class:"no-results"},N={key:1,class:"results-grid"},O=["onClick"],U={class:"result-poster"},A=["src","alt"],E={class:"result-overlay"},H={class:"result-actions"},Z=["onClick"],P={key:0,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},W={key:1,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},z={class:"result-info"},G={class:"result-title"},J={class:"result-meta"},K={class:"result-type"},X={class:"result-year"},$={key:0,class:"result-rating"},ee={key:0,class:"result-overview"},te={key:1,class:"result-cast"};function se(s,e,o,re,n,a){return l(),i("div",V,[t("section",M,[t("div",x,[t("div",I,[t("h1",B,[e[3]||(e[3]=_("Search Results for ")),t("span",R,'"'+d(n.searchQuery)+'"',1)]),t("div",b,[t("div",Q,[h(t("select",{"onUpdate:modelValue":e[0]||(e[0]=r=>n.contentType=r)},e[4]||(e[4]=[t("option",{value:"all"},"All Content",-1),t("option",{value:"movies"},"Movies Only",-1),t("option",{value:"shows"},"TV Shows Only",-1)]),512),[[v,n.contentType]]),e[5]||(e[5]=t("svg",{class:"select-arrow",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[t("path",{d:"M7 10L12 15L17 10",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"})],-1))]),t("div",j,[h(t("select",{"onUpdate:modelValue":e[1]||(e[1]=r=>n.sortBy=r)},e[6]||(e[6]=[t("option",{value:"relevance"},"Sort by Relevance",-1),t("option",{value:"rating"},"Sort by Rating",-1),t("option",{value:"year"},"Sort by Release Date",-1),t("option",{value:"title"},"Sort by Title",-1)]),512),[[v,n.sortBy]]),e[7]||(e[7]=t("svg",{class:"select-arrow",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[t("path",{d:"M7 10L12 15L17 10",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"})],-1))])])])])]),n.isLoading?(l(),i("div",D,e[8]||(e[8]=[t("div",{class:"loading-spinner"},null,-1),t("p",null,"Searching...",-1)]))):n.error?(l(),i("div",F,[t("p",null,d(n.error),1),t("button",{onClick:e[2]||(e[2]=(...r)=>a.performSearch&&a.performSearch(...r)),class:"retry-button"},"Try Again")])):(l(),i("section",Y,[a.filteredResults.length===0?(l(),i("div",q,e[9]||(e[9]=[t("h2",null,"No results found",-1),t("p",null,"Try adjusting your search terms or filters",-1)]))):(l(),i("div",N,[(l(!0),i(g,null,w(a.filteredResults,r=>{var u;return l(),i("div",{key:r.id,class:"result-card",onClick:y=>a.navigateToDetails(r)},[t("div",U,[t("img",{src:a.getImageUrl(r.poster_path),alt:r.title||r.name},null,8,A),t("div",E,[t("div",H,[t("button",{class:"action-button",onClick:C(y=>a.addToWatchlist(r),["stop"]),title:"Add to My List"},[a.isItemSaved(r)?(l(),i("svg",P,e[10]||(e[10]=[t("path",{d:"M17 3H7C5.9 3 5 3.9 5 5V21L12 18L19 21V5C19 3.9 18.1 3 17 3Z",fill:"currentColor"},null,-1)]))):(l(),i("svg",W,e[11]||(e[11]=[t("path",{d:"M17 3H7C5.9 3 5 3.9 5 5V21L12 18L19 21V5C19 3.9 18.1 3 17 3ZM17 18L12 15.82L7 18V5H17V18Z",fill:"currentColor"},null,-1)])))],8,Z)])])]),t("div",z,[t("h3",G,d(r.title||r.name),1),t("div",J,[t("span",K,d(r.media_type==="movie"?"Movie":"TV Show"),1),t("span",X,d(a.getYear(r)),1),r.vote_average?(l(),i("span",$,"â˜… "+d(r.vote_average.toFixed(1)),1)):c("",!0)]),r.overview?(l(),i("p",ee,d(a.truncateOverview(r.overview)),1)):c("",!0),(u=r.credits)!=null&&u.cast?(l(),i("div",te," Starring: "+d(a.getCastList(r.credits.cast)),1)):c("",!0)])],8,O)}),128))]))]))])}const ie=p(T,[["render",se],["__scopeId","data-v-5386ba26"]]);export{ie as default};
